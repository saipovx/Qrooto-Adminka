{"ast":null,"code":"import _objectSpread from\"/home/t1/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/kuplatform/admin-stage/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/home/t1/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/kuplatform/admin-stage/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/t1/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/kuplatform/admin-stage/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from'axios';import a from'../Admin/Admin.module.scss';import React,{useEffect,useState}from'react';import InvitationCard from'./InbitationCard';import{useAuth}from'../../AuthContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{createElement as _createElement}from\"react\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Invitation(_ref){var userMe=_ref.userMe;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),userId=_useState2[0],setUserId=_useState2[1];var apiUrl=process.env.REACT_APP_API_URL;var loginEndpoint='/api/rights/all';var token=localStorage.getItem('access_token');var _useAuth=useAuth(),refreshToken=_useAuth.refreshToken;useEffect(function(){var url=\"\".concat(apiUrl).concat(loginEndpoint);axios.get(url,{headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)}}).then(function(res){setUserId(res.data);}).catch(function(error){if(error.response&&error.response.status===401){refreshToken();}else{}});},[refreshToken]);var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),selectedItems=_useState4[0],setSelectedItems=_useState4[1];var toggleCheckbox=function toggleCheckbox(code){if(selectedItems.includes(code)){setSelectedItems(selectedItems.filter(function(item){return item!==code;}));}else{setSelectedItems([].concat(_toConsumableArray(selectedItems),[code]));}};// const toggleCheckbox = (code) => {\n//     if (userMe.includes('superadmin')) {\n//       // Если есть роль 'superadmin', разрешаем выбор всех чекбоксов\n//       setSelectedItems(userId.map(info => info.code));\n//     } else if (userMe.includes('admin')) {\n//       // Если есть роль 'admin', разрешаем выбор только 'admin'\n//       if (code === 'admin') {\n//         setSelectedItems(['admin']);\n//       } else {\n//         setSelectedItems([]);\n//       }\n//     } else if (userMe.includes(code)) {\n//       // Если есть роль, совпадающая с текущим чекбоксом, разрешаем его выбор\n//       setSelectedItems([code]);\n//     } else {\n//       // В остальных случаях скрываем все чекбоксы\n//       setSelectedItems([]);\n//     }\n//   };\nvar _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),roleName=_useState6[0],setRoleName=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),roleEmail=_useState8[0],setRoleEmail=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),ErrorValid=_useState10[0],setErrorValid=_useState10[1];var loginEndpointPOST='/api/users_admin/send_invite';var RoleHandle=function RoleHandle(e){e.preventDefault();axios.post(\"\".concat(apiUrl).concat(loginEndpointPOST),{name:roleName,email:roleEmail,role:selectedItems},{headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)}}).then(function(res){// console.log(res);\n}).catch(function(error){setErrorValid(true);});};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"section\",{className:a.section__home,children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"p\",{className:a.invitation__title,children:\"\\u041F\\u0440\\u0438\\u0433\\u043B\\u0430\\u0448\\u0435\\u043D\\u0438\\u0435 \\u0432 \\u0430\\u0434\\u043C\\u0438\\u043D\\u043A\\u0443\"}),/*#__PURE__*/_jsxs(\"form\",{className:a.invitation,onSubmit:RoleHandle,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:a.invitation__input,placeholder:\"\\u0418\\u043C\\u044F \\u0424\\u0430\\u043C\\u0438\\u043B\\u0438\\u044F\",onChange:function onChange(event){return setRoleName(event.target.value);}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:a.invitation__input,placeholder:\"\\u041F\\u043E\\u0447\\u0442\\u0430\",onChange:function onChange(event){return setRoleEmail(event.target.value);}}),/*#__PURE__*/_jsx(\"div\",{className:a.invitation__center,children:userId.map(function(info,index){return/*#__PURE__*/_createElement(InvitationCard,_objectSpread(_objectSpread({},info),{},{key:index,isSelected:selectedItems.includes(info.code),onCheckboxChange:function onCheckboxChange(){return toggleCheckbox(info.code);}}));})}),/*#__PURE__*/_jsx(\"button\",{className:a.invitation__btn,onClick:RoleHandle,children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\"})]})]})})});}","map":{"version":3,"names":["axios","a","React","useEffect","useState","InvitationCard","useAuth","jsx","_jsx","createElement","_createElement","jsxs","_jsxs","Fragment","_Fragment","Invitation","_ref","userMe","_useState","_useState2","_slicedToArray","userId","setUserId","apiUrl","process","env","REACT_APP_API_URL","loginEndpoint","token","localStorage","getItem","_useAuth","refreshToken","url","concat","get","headers","then","res","data","catch","error","response","status","_useState3","_useState4","selectedItems","setSelectedItems","toggleCheckbox","code","includes","filter","item","_toConsumableArray","_useState5","_useState6","roleName","setRoleName","_useState7","_useState8","roleEmail","setRoleEmail","_useState9","_useState10","ErrorValid","setErrorValid","loginEndpointPOST","RoleHandle","e","preventDefault","post","name","email","role","children","className","section__home","invitation__title","invitation","onSubmit","type","invitation__input","placeholder","onChange","event","target","value","invitation__center","map","info","index","_objectSpread","key","isSelected","onCheckboxChange","invitation__btn","onClick"],"sources":["/home/t1/Рабочий стол/kuplatform/admin-stage/src/pages/Invitation/Invitation.jsx"],"sourcesContent":["import axios from 'axios';\nimport a from '../Admin/Admin.module.scss'\nimport React, { useEffect, useState } from 'react';\nimport InvitationCard from './InbitationCard';\nimport { useAuth } from '../../AuthContext';\n\n\nexport default function Invitation ({userMe}) {\n\n    const [userId, setUserId] = useState([])\n\n    const apiUrl = process.env.REACT_APP_API_URL;\n\n    const loginEndpoint = '/api/rights/all';\n\n    const token = localStorage.getItem('access_token');\n\n    const { refreshToken } = useAuth();\n\n    useEffect(() => {\n    \n        const url = `${apiUrl}${loginEndpoint}`;\n    \n            axios.get(url, {\n\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${token}` \n                }\n\n            })\n            .then(res => {\n\n                setUserId(res.data)\n\n            })\n\n            .catch(error => {\n\n              if (error.response && error.response.status === 401) {\n\n                refreshToken();\n\n              } else {\n\n              }\n                \n            });\n\n    }, [refreshToken]); \n\n\n     \n\n    const [selectedItems, setSelectedItems] = useState([]);\n\n    const toggleCheckbox = (code) => {\n\n        if (selectedItems.includes(code)) {\n\n            setSelectedItems(selectedItems.filter(item => item !== code));\n\n        } else {\n            setSelectedItems([...selectedItems, code]);\n        }\n\n      };\n\n    // const toggleCheckbox = (code) => {\n\n    //     if (userMe.includes('superadmin')) {\n    //       // Если есть роль 'superadmin', разрешаем выбор всех чекбоксов\n    //       setSelectedItems(userId.map(info => info.code));\n\n    //     } else if (userMe.includes('admin')) {\n    //       // Если есть роль 'admin', разрешаем выбор только 'admin'\n    //       if (code === 'admin') {\n    //         setSelectedItems(['admin']);\n    //       } else {\n    //         setSelectedItems([]);\n    //       }\n    //     } else if (userMe.includes(code)) {\n    //       // Если есть роль, совпадающая с текущим чекбоксом, разрешаем его выбор\n    //       setSelectedItems([code]);\n    //     } else {\n    //       // В остальных случаях скрываем все чекбоксы\n    //       setSelectedItems([]);\n    //     }\n    //   };\n      \n\n      const [roleName, setRoleName] = useState('')\n\n      const [roleEmail, setRoleEmail] = useState('')\n\n      const [ErrorValid, setErrorValid]= useState(false)\n\n      const loginEndpointPOST = '/api/users_admin/send_invite';\n      \n      const RoleHandle = (e) => {\n\n          e.preventDefault();\n      \n          axios\n            .post(`${apiUrl}${loginEndpointPOST}`, {\n  \n              name: roleName,\n              email: roleEmail,\n              role: selectedItems\n  \n            }, {\n              \n              headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${token}` \n              },\n  \n            })\n\n            .then((res) => { \n                \n                // console.log(res);\n\n            })\n  \n            .catch((error) => {\n\n              setErrorValid(true);\n\n            });\n  \n        };\n\n    return (\n        \n        <>\n\n        \n        <section className={a.section__home}>\n\n            <div className=\"container\">\n                \n                <p className={a.invitation__title}>Приглашение в админку</p>\n\n                <form className={a.invitation} onSubmit={RoleHandle}>\n                    \n                    <input type=\"text\" className={a.invitation__input} placeholder='Имя Фамилия'\n                    onChange={(event) => setRoleName(event.target.value)}\n                    />\n\n                    <input type=\"text\" className={a.invitation__input} placeholder='Почта'\n                    onChange={(event) => setRoleEmail(event.target.value)}\n                    />\n\n                    <div className={a.invitation__center}>\n\n\n                  {userId.map( (info, index) => { \n\n                    return (\n\n                        <InvitationCard {...info}  key={index}\n                         \n                        isSelected={selectedItems.includes(info.code)}\n                        onCheckboxChange={() => toggleCheckbox(info.code)}\n                         \n                        />\n                              \n                    ) \n\n                  } ) } \n\n                        \n\n                    </div>\n\n\n                    <button className={a.invitation__btn} onClick={RoleHandle}>\n                        Добавить \n                    </button>\n\n                </form>\n\n            </div>\n        </section>\n\n        </>\n\n    )\n    \n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}