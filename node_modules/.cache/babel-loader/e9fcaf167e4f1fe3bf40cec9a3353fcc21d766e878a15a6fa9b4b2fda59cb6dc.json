{"ast":null,"code":"import _objectSpread from\"/home/t1/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/kuplatform/admin-stage/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/t1/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/kuplatform/admin-stage/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from'axios';import a from'../Admin/Admin.module.scss';import React,{useEffect,useState}from'react';import InvitationCard from'./InbitationCard';import{jsx as _jsx}from\"react/jsx-runtime\";import{createElement as _createElement}from\"react\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Invitation(_ref){var userMe=_ref.userMe;console.log(userMe);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),userId=_useState2[0],setUserId=_useState2[1];var apiUrl=process.env.REACT_APP_API_URL;var loginEndpoint='/api/rights/all';var token=localStorage.getItem('access_token');useEffect(function(){var url=\"\".concat(apiUrl).concat(loginEndpoint);axios.get(url,{headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)}}).then(function(res){setUserId(res.data);}).catch(function(error){});},[]);var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),selectedItems=_useState4[0],setSelectedItems=_useState4[1];// const toggleCheckbox = (code) => {\n//     if (selectedItems.includes(code)) {\n//         setSelectedItems(selectedItems.filter(item => item !== code));\n//     } else {\n//         setSelectedItems([...selectedItems, code]);\n//     }\n//   };\nvar toggleCheckbox=function toggleCheckbox(code){if(userMe.includes('superadmin')){// Если есть роль 'superadmin', разрешаем выбор всех чекбоксов\nsetSelectedItems(userId.map(function(info){return info.code;}));}else if(userMe.includes('admin')){// Если есть роль 'admin', разрешаем выбор только 'admin'\nif(code==='admin'){setSelectedItems(['admin']);}else{setSelectedItems([]);}}else if(userMe.includes(code)){// Если есть роль, совпадающая с текущим чекбоксом, разрешаем его выбор\nsetSelectedItems([code]);}else{// В остальных случаях скрываем все чекбоксы\nsetSelectedItems([]);}};var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),roleName=_useState6[0],setRoleName=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),roleEmail=_useState8[0],setRoleEmail=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),ErrorValid=_useState10[0],setErrorValid=_useState10[1];var loginEndpointPOST='/api/users_admin/send_invite';var RoleHandle=function RoleHandle(e){e.preventDefault();axios.post(\"\".concat(apiUrl).concat(loginEndpointPOST),{name:roleName,email:roleEmail,role:selectedItems},{headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)}}).then(function(res){console.log(res);}).catch(function(error){setErrorValid(true);});};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"section\",{className:a.section__home,children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"p\",{className:a.invitation__title,children:\"\\u041F\\u0440\\u0438\\u0433\\u043B\\u0430\\u0448\\u0435\\u043D\\u0438\\u0435 \\u0432 \\u0430\\u0434\\u043C\\u0438\\u043D\\u043A\\u0443\"}),/*#__PURE__*/_jsxs(\"form\",{className:a.invitation,onSubmit:RoleHandle,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:a.invitation__input,placeholder:\"\\u0418\\u043C\\u044F \\u0424\\u0430\\u043C\\u0438\\u043B\\u0438\\u044F\",onChange:function onChange(event){return setRoleName(event.target.value);}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:a.invitation__input,placeholder:\"\\u041F\\u043E\\u0447\\u0442\\u0430\",onChange:function onChange(event){return setRoleEmail(event.target.value);}}),/*#__PURE__*/_jsx(\"div\",{className:a.invitation__center,children:userId.map(function(info,index){return/*#__PURE__*/_createElement(InvitationCard,_objectSpread(_objectSpread({},info),{},{key:index,isSelected:selectedItems.includes(info.code),onCheckboxChange:function onCheckboxChange(){return toggleCheckbox(info.code);}}));})}),/*#__PURE__*/_jsx(\"button\",{className:a.invitation__btn,onClick:RoleHandle,children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\"})]})]})})});}","map":{"version":3,"names":["axios","a","React","useEffect","useState","InvitationCard","jsx","_jsx","createElement","_createElement","jsxs","_jsxs","Fragment","_Fragment","Invitation","_ref","userMe","console","log","_useState","_useState2","_slicedToArray","userId","setUserId","apiUrl","process","env","REACT_APP_API_URL","loginEndpoint","token","localStorage","getItem","url","concat","get","headers","then","res","data","catch","error","_useState3","_useState4","selectedItems","setSelectedItems","toggleCheckbox","code","includes","map","info","_useState5","_useState6","roleName","setRoleName","_useState7","_useState8","roleEmail","setRoleEmail","_useState9","_useState10","ErrorValid","setErrorValid","loginEndpointPOST","RoleHandle","e","preventDefault","post","name","email","role","children","className","section__home","invitation__title","invitation","onSubmit","type","invitation__input","placeholder","onChange","event","target","value","invitation__center","index","_objectSpread","key","isSelected","onCheckboxChange","invitation__btn","onClick"],"sources":["/home/t1/Рабочий стол/kuplatform/admin-stage/src/pages/Invitation/Invitation.jsx"],"sourcesContent":["import axios from 'axios';\nimport a from '../Admin/Admin.module.scss'\nimport React, { useEffect, useState } from 'react';\nimport InvitationCard from './InbitationCard';\n\n\nexport default function Invitation ({userMe}) {\n\n    console.log(userMe);\n\n    const [userId, setUserId] = useState([])\n\n    const apiUrl = process.env.REACT_APP_API_URL;\n\n    const loginEndpoint = '/api/rights/all';\n\n    const token = localStorage.getItem('access_token');\n\n    useEffect(() => {\n    \n        const url = `${apiUrl}${loginEndpoint}`;\n    \n            axios.get(url, {\n\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${token}` \n                }\n\n            })\n            .then(res => {\n\n                setUserId(res.data)\n\n            })\n\n            .catch(error => {\n                \n            });\n\n    }, []); \n     \n\n    const [selectedItems, setSelectedItems] = useState([]);\n\n    // const toggleCheckbox = (code) => {\n\n    //     if (selectedItems.includes(code)) {\n\n    //         setSelectedItems(selectedItems.filter(item => item !== code));\n\n    //     } else {\n    //         setSelectedItems([...selectedItems, code]);\n    //     }\n\n    //   };\n\n    const toggleCheckbox = (code) => {\n\n        if (userMe.includes('superadmin')) {\n          // Если есть роль 'superadmin', разрешаем выбор всех чекбоксов\n          setSelectedItems(userId.map(info => info.code));\n          \n        } else if (userMe.includes('admin')) {\n          // Если есть роль 'admin', разрешаем выбор только 'admin'\n          if (code === 'admin') {\n            setSelectedItems(['admin']);\n          } else {\n            setSelectedItems([]);\n          }\n        } else if (userMe.includes(code)) {\n          // Если есть роль, совпадающая с текущим чекбоксом, разрешаем его выбор\n          setSelectedItems([code]);\n        } else {\n          // В остальных случаях скрываем все чекбоксы\n          setSelectedItems([]);\n        }\n      };\n      \n\n      const [roleName, setRoleName] = useState('')\n\n      const [roleEmail, setRoleEmail] = useState('')\n\n      const [ErrorValid, setErrorValid]= useState(false)\n\n      const loginEndpointPOST = '/api/users_admin/send_invite';\n      \n      const RoleHandle = (e) => {\n\n          e.preventDefault();\n      \n          axios\n            .post(`${apiUrl}${loginEndpointPOST}`, {\n  \n              name: roleName,\n              email: roleEmail,\n              role: selectedItems\n  \n            }, {\n              \n              headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${token}` \n              },\n  \n            })\n\n            .then((res) => { \n                \n                console.log(res);\n\n            })\n  \n            .catch((error) => {\n\n              setErrorValid(true);\n\n            });\n  \n        };\n\n    return (\n        \n        <>\n\n        \n        <section className={a.section__home}>\n\n            <div className=\"container\">\n                \n                <p className={a.invitation__title}>Приглашение в админку</p>\n\n                <form className={a.invitation} onSubmit={RoleHandle}>\n                    \n                    <input type=\"text\" className={a.invitation__input} placeholder='Имя Фамилия'\n                    onChange={(event) => setRoleName(event.target.value)}\n                    />\n\n                    <input type=\"text\" className={a.invitation__input} placeholder='Почта'\n                    onChange={(event) => setRoleEmail(event.target.value)}\n                    />\n\n                    <div className={a.invitation__center}>\n\n\n                  {userId.map( (info, index) => { \n\n                    return (\n\n                        <InvitationCard {...info}  key={index}\n                         \n                        isSelected={selectedItems.includes(info.code)}\n                        onCheckboxChange={() => toggleCheckbox(info.code)}\n                         \n                        />\n                              \n                    ) \n\n                  } ) } \n\n                        \n\n                    </div>\n\n\n                    <button className={a.invitation__btn} onClick={RoleHandle}>\n                        Добавить \n                    </button>\n\n                </form>\n\n            </div>\n        </section>\n\n        </>\n\n    )\n    \n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}